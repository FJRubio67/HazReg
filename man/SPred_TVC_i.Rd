% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/routines.R
\name{SPred_TVC_i}
\alias{SPred_TVC_i}
\title{Compute the Individual Survival Function at an Arbitrary Time Point
for a Proportional Hazards or Accelerated Failure Model
(2- and 3-parameter baseline)}
\usage{
SPred_TVC_i(df, i, t, beta, npar, ae0, be0, ce0 = NULL, chfun, hstr)
}
\arguments{
\item{df}{A data frame containing:
\itemize{
  \item `ID`: individual identifier.
  \item `time`: numeric vector of observation times.
  \item Covariate columns named with prefix `"des"` (e.g., `des1`, `des2`, ...),
        representing the time-varying covariate process \eqn{x_i(t)}.
}}

\item{i}{Integer specifying the individual for whom the survival
function is to be evaluated.}

\item{t}{Numeric value giving the time point at which the survival
function is evaluated. Must lie within the observation window of
individual `i`.}

\item{beta}{Numeric vector of regression coefficients.}

\item{npar}{Number of parameters in the baseline hazard (2 or 3).}

\item{ae0, be0, ce0}{Numeric baseline parameters of the cumulative hazard.
Argument `ce0` is required only when `npar = 3`.}

\item{chfun}{A function computing the baseline cumulative hazard:
`chfun(time, ae0, be0)` or `chfun(time, ae0, be0, ce0)`.}

\item{hstr}{Character string specifying the hazard structure:
`"PH"` for proportional hazards or `"AFT"` for accelerated failure time.}
}
\value{
A numeric scalar giving the survival probability
  \eqn{S_i(t)} for individual `i` at time `t`.
}
\description{
Computes the individual-specific survival function
\eqn{S_i(t) = \exp\{-H_i(t \mid x_i(t))\}}
at a user-specified time point \eqn{t} for a given individual \eqn{i},
under a proportional hazards (PH) model or an accelerated failure time (AFT) model
with time-varying covariates.
}
\details{
The cumulative hazard for individual \eqn{i} is defined as:

\deqn{
H_i(t \mid x_i(t)) = \int_0^t h_0(u; a_0, b_0, c_0)
\exp\{x_i(u)^\top \beta\} \, du
}

for the PH model, and

\deqn{
H_i(t \mid x_i(t)) = H_0\!\left(t \exp\{x_i(t)^\top \beta\};
a_0, b_0, c_0 \right)
}

for the AFT model.

Time-varying covariates are assumed to be piecewise constant between
the observation times provided in `df`. If the evaluation time `t`
does not coincide with an observed time point for individual `i`,
the covariate values are taken to be those at the most recent time
strictly less than `t`.


This function relies on `CH_TVC()` to compute the cumulative hazard
over the observed time grid augmented with the evaluation time `t`.
The cumulative hazard is then extracted at time `t`, and the survival
function is obtained as \eqn{\exp\{-H_i(t)\}}.

The resulting survival function is continuous in time but may exhibit
changes in slope at covariate change points, reflecting the
piecewise-constant nature of the time-varying covariates.
}
\seealso{
\code{\link{CH_TVC}}, \code{\link{SPred_TVC}}
}
