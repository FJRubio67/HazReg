% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/routines.R
\name{sim_TVC}
\alias{sim_TVC}
\title{Simulate Event Times from a Time-Varying Covariates Survival Model}
\usage{
sim_TVC(seed, df, chfun, hstr, theta, beta)
}
\arguments{
\item{seed}{Integer random seed for reproducibility.}

\item{df}{A data frame containing the longitudinal covariate information with:
\itemize{
  \item \code{ID}: individual identifier.
  \item \code{time}: observation times for covariate measurements.
  \item Covariate columns named with prefix \code{"des"}
        (e.g., \code{des1}, \code{des2}, ...).
}
Covariates are assumed to be piecewise constant between observation times.}

\item{chfun}{A function computing the baseline cumulative hazard,
e.g. \code{chfun(time, ...)}.}

\item{hstr}{Character string specifying the hazard structure.
Either \code{"PH"} for proportional hazards or \code{"AFT"} for
accelerated failure time models.}

\item{theta}{Numeric vector of baseline hazard parameters. The length of
\code{theta} determines whether a two- or three-parameter baseline is used.}

\item{beta}{Numeric vector of regression coefficients corresponding to the
time-varying covariates.}
}
\value{
A list with components:
  \itemize{
    \item \code{time}: numeric vector of simulated event or censoring times.
    \item \code{status}: event indicator (1 = event, 0 = right-censored).
  }
}
\description{
Simulates event times from a survival model with time-varying covariates
using the probability integral transform. The function supports
proportional hazards (PH) and accelerated failure time (AFT) models
with parametric baseline hazards.
}
\details{
For each individual \eqn{i}, a uniform random variable \eqn{U_i \sim \mathrm{Unif}(0,1)}
is generated. If the survival probability at the last observed time
\eqn{t_{\max,i}} satisfies
\deqn{S_i(t_{\max,i}) > U_i,}
the individual is right-censored at \eqn{t_{\max,i}}. Otherwise, the event
time \eqn{T_i} is obtained by solving
\deqn{S_i(t) = U_i}
for \eqn{t \in (0, t_{\max,i}]}, where \eqn{S_i(t)} is the individual-specific
survival function accounting for time-varying covariates.

The survival function is evaluated via \code{\link{SPred_TVC}} and
\code{\link{SPred_TVC_i}}, ensuring consistency with the underlying
cumulative hazard specification.


The simulation assumes that covariates are left-continuous and piecewise
constant over time. Event times are generated conditional on the observed
covariate history up to the last follow-up time for each individual.

This function is suitable for simulation studies involving time-varying
covariates under parametric PH or AFT models.
}
\seealso{
\code{\link{CH_TVC}}, \code{\link{SPred_TVC}}, \code{\link{SPred_TVC_i}}
}
